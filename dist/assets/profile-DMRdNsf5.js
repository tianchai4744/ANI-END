import{o as s,b as l,u as r,i as m,d as c,a as u,n as p}from"./db-config-JzEx42YR.js";import{l as h}from"./navbar-DtgS--Xs.js";import"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";let a=null;document.addEventListener("DOMContentLoaded",async()=>{await h(".."),s(l,async e=>{e?(a=e,document.getElementById("profile-content").classList.remove("hidden"),document.getElementById("loading-state").classList.add("hidden"),document.getElementById("input-name").value=e.displayName||"",document.getElementById("input-photo").value=e.photoURL||"",document.getElementById("preview-avatar").src=e.photoURL||`https://ui-avatars.com/api/?name=${e.email.charAt(0)}`,document.getElementById("user-email-display").textContent=e.email):window.location.href="/index.html"}),document.getElementById("profile-form").addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("btn-save"),d=t.innerHTML;t.innerHTML='<i class="ri-loader-4-line animate-spin"></i> กำลังบันทึก...',t.disabled=!0;try{const n=document.getElementById("input-name").value.trim(),o=document.getElementById("input-photo").value.trim();if(!n)throw new Error("กรุณากรอกชื่อ");await r(a,{displayName:n,photoURL:o||null});const i=m(c,`artifacts/${u}/users/${a.uid}`);await p(i,{displayName:n,photoURL:o||null}),window.showToast("บันทึกข้อมูลเรียบร้อย","success"),setTimeout(()=>window.location.reload(),1e3)}catch(n){console.error(n),window.showToast("เกิดข้อผิดพลาด: "+n.message,"error"),t.innerHTML=d,t.disabled=!1}}),document.getElementById("input-photo").addEventListener("input",e=>{const t=e.target.value;t&&(document.getElementById("preview-avatar").src=t)})});
